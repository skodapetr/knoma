"use strict";(self.webpackChunkknoma=self.webpackChunkknoma||[]).push([[179],{346:(e,t,o)=>{var i=o(963),n=o(201),l=o(570),a=(o(757),o(291)),s=o(336),r=o(467),u=o(252),d=o(577);const c=(0,u._)("h2",null,"Instance",-1),p=(0,u._)("dt",null,"Database:",-1);var m;!function(e){e[e.HTTP=0]="HTTP",e[e.LOCAL_STORAGE=1]="LOCAL_STORAGE"}(m||(m={}));const h={domain:"http://localhost/",database:1};function v(){return h}var f,g=o(861);!function(e){e.String="string",e.Date="date",e.Codelist="codelist"}(f||(f={}));const w={"http://www.w3.org/2004/02/skos/core#ConceptScheme":"Concept Scheme","http://www.w3.org/2004/02/skos/core#Concept":"Concept","http://www.w3.org/2000/01/rdf-schema#Property":"Property","http://www.w3.org/2000/01/rdf-schema#Class":"Class"},y={"http://www.w3.org/2000/01/rdf-schema#Class":["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://www.w3.org/2004/02/skos/core#Concept","http://www.w3.org/2000/01/rdf-schema#Property","http://www.w3.org/2000/01/rdf-schema#Class"]},b=[{iri:"http://www.w3.org/2004/02/skos/core#inScheme",label:"In scheme",multiple:!0,type:f.Codelist,codelist:["http://www.w3.org/2004/02/skos/core#ConceptScheme"],domain:["http://www.w3.org/2004/02/skos/core#Concept"],listColour:void 0,listPriority:void 0},{iri:"https://skodapetr.github.io/knoma/vocabulary#url",label:"URL",multiple:!1,type:f.String,codelist:void 0,domain:void 0,listColour:void 0,listPriority:void 0},{iri:"https://skodapetr.github.io/knoma/vocabulary#doi",label:"DOI",multiple:!1,type:f.String,codelist:void 0,domain:void 0,listColour:void 0,listPriority:void 0},{iri:"https://skodapetr.github.io/knoma/vocabulary#author",label:"Author",multiple:!1,type:f.String,codelist:void 0,domain:void 0,listColour:void 0,listPriority:void 0},{iri:"https://skodapetr.github.io/knoma/vocabulary#published",label:"Published",multiple:!1,type:f.Date,codelist:void 0,domain:void 0,listColour:void 0,listPriority:void 0},{iri:"http://www.w3.org/2000/01/rdf-schema#domain",label:"Domain",multiple:!0,type:f.Codelist,codelist:["http://www.w3.org/2004/02/skos/core#ConceptScheme"],domain:["http://www.w3.org/2000/01/rdf-schema#Property"],listColour:void 0,listPriority:void 0},{iri:"https://skodapetr.github.io/knoma/vocabulary#ref",label:"Reference",multiple:!1,type:f.String,codelist:void 0,domain:void 0,listColour:void 0,listPriority:void 0},{iri:"https://skodapetr.github.io/knoma/vocabulary#listColor",label:"List color",multiple:!1,type:f.String,codelist:void 0,domain:void 0,listColour:void 0,listPriority:void 0},{iri:"https://skodapetr.github.io/knoma/vocabulary#listPriority",label:"List priority",multiple:!1,type:f.String,codelist:void 0,domain:void 0,listColour:void 0,listPriority:void 0}];function C(e){return y[e]||[]}!function(){for(const e of b)w[e.iri]=e.label}();const k="https://skodapetr.github.io/knoma/vocabulary#Quote";class D{documents=[];async getDocuments(){return await this.refreshDocuments(),this.documents}async getPredicates(){await this.refreshDocuments();const e=[...b];for(const t of this.documents)t.types.includes("http://www.w3.org/2000/01/rdf-schema#Property")&&e.push(W(t));return e}async getPredicate(e){const t=await this.getPredicates();for(const o of t)if(o.iri===e)return o}async getCodelist(e){await this.refreshDocuments();const t=new Set;for(const o of e)for(const e of C(o))t.add(e);for(const o of this.documents)(V(o.properties["http://www.w3.org/2004/02/skos/core#inScheme"]||[],e)||V(o.types,e))&&t.add(o.iri);return[...t]}async getLabel(e){const t=w[e];if(void 0!==t)return t;for(const t of this.documents)if(t.iri===e)return t.title;return e}}function V(e,t){for(const o of e)if(t.includes(o))return!0;return!1}function W(e){const t=e.properties["http://www.w3.org/2000/01/rdf-schema#domain"],o=e.properties["https://skodapetr.github.io/knoma/vocabulary#listColor"],i=e.properties["https://skodapetr.github.io/knoma/vocabulary#listPriority"];return{iri:e.iri,label:e.title,multiple:!0,type:void 0===t?f.String:f.Codelist,codelist:t||[],domain:void 0,listColour:o?.[0],listPriority:parseInt(i?.[0]??"0")}}class _ extends D{documentsAreDirty=!0;getDatabaseLabel(){return"HTTP Based"}async refreshDocuments(){if(this.documentsAreDirty){const e=await g.Z.get("api/v1/documents");this.documents=e.data,this.documentsAreDirty=!1}}async getDocument(e){const t="api/v1/documents?iri="+encodeURIComponent(e);return(await g.Z.get(t)).data}async storeDocument(e){const t="api/v1/documents?iri="+encodeURIComponent(e.iri);await g.Z.post(t,e),this.documentsAreDirty=!0}async deleteDocument(e){const t="api/v1/documents?iri="+encodeURIComponent(e);await g.Z.delete(t),this.documentsAreDirty=!0}}const S="documents-list";class P extends D{getDatabaseLabel(){return"Local Storage"}async deleteDocument(e){localStorage.removeItem(e);const t=this.findDocument(e);void 0!==t&&(this.documents.splice(t,1),this.saveDocuments())}findDocument(e){for(let t=0;t<this.documents.length;++t)if(this.documents[t].iri===e)return t}saveDocuments(){const e=JSON.stringify(this.documents);localStorage.setItem(S,e)}async getDocument(e){const t=localStorage.getItem(e);if(null!==t)return JSON.parse(t)}async refreshDocuments(){if(this.documents.length>0)return;const e=localStorage.getItem(S);null!==e&&(this.documents=JSON.parse(e))}async storeDocument(e){const t=JSON.stringify(e);localStorage.setItem(e.iri,t);const o={iri:e.iri,types:e.types,title:e.title,description:e.description,created:e.created,properties:e.properties},i=this.findDocument(e.iri);void 0===i?this.documents=[o,...this.documents]:this.documents[i]=o,this.saveDocuments()}}const I=function(){switch(v().database){case m.HTTP:return new _;case m.LOCAL_STORAGE:default:return function(){const e=new P;return null===localStorage.getItem(S)&&function(e){const t=(new Date).toISOString().substr(0,10);e.storeDocument({iri:"http://example.com/note/001",created:t,title:"Click me!",description:"Welcome to Knowledge Manager.",types:[],properties:{"https://skodapetr.github.io/knoma/vocabulary#author":["Petr Škoda"]},items:[{identifier:"001",types:[],properties:{},created:t,text:"There might be a tutorial one day ... ",image:void 0},{identifier:"002",types:[],properties:{},created:t,text:"This instance is using your local storage to store data.",image:void 0}]})}(e),e}()}}();function U(){return I}const T={name:"AboutInstance",data:()=>({databaseLabel:U().getDatabaseLabel()})};var x=o(744);const $=(0,x.Z)(T,[["render",function(e,t,o,i,n,l){return(0,u.wg)(),(0,u.iD)("section",null,[c,(0,u._)("dl",null,[p,(0,u._)("dd",null,(0,d.zw)(e.databaseLabel),1)])])}]]),A=[(0,u.uE)("<h2>Keyboard</h2><dl><dt>ctrl + s</dt><dd>In document detail, save current document.</dd><dt>alt + a</dt><dd>In document detail, append new note.</dd><dt>alt + up</dt><dd>In note text area, focus previous note.</dd><dt>alt + down</dt><dd>In note text area, focus next note.</dd><dt>alt + q</dt><dd>In note text area, toggle quote switch.</dd></dl>",2)],O={name:"AboutKeyboard"},L=(0,x.Z)(O,[["render",function(e,t,o,i,n,l){return(0,u.wg)(),(0,u.iD)("section",null,A)}]]),j=[(0,u.uE)("<h2>Predicates</h2><dl><dt>In scheme</dt><dd>Part of a given scheme/codelist.</dd><dt>URL</dt><dd></dd><dt>DOI</dt><dd></dd><dt>Published</dt><dd>Time when the document were published/created.</dd><dt>Reference</dt><dd>Can be used to connect notes together.</dd></dl>",2)],q={name:"AboutPredicates"},E=(0,x.Z)(q,[["render",function(e,t,o,i,n,l){return(0,u.wg)(),(0,u.iD)("section",null,j)}]]),z=[(0,u.uE)("<h2>Content language</h2><ul><li> Link with given <em>name</em> and <em>URL</em>.<br><code>[{name}}]({URL}})</code><br> There are some specific domains that can be used: <ul><li><code>doi://</code> - Reference to a document with DOI. </li><li><code>cite://</code> - Reference to a citation inside a document. </li></ul></li><li> Highlight given word as important.<br><code>**Keyword**</code></li><li> Code without any other specification.<br><code>```code```</code></li><li> Code of given <em>{type}</em>: <pre><code>```{type}\n...\n```</code></pre> You can use <code>```Quote...</code> to mark a quote from the source document. Alternatively you can mark whole note as a quote. </li><li> Item list: <pre><code>* Item\n* Item\n* Item</code></pre></li></ul>",2)],K={name:"AboutText"},Z=(0,x.Z)(K,[["render",function(e,t,o,i,n,l){return(0,u.wg)(),(0,u.iD)("section",null,z)}]]),H=[(0,u.uE)("<h2>Types</h2><dl><dt>Concept Scheme</dt><dd>A concept lists that can be used as values in codelists.</dd><dt>Concept</dt><dd>Member of concept scheme.</dd><dt>Property</dt><dd>This document can be used as a property.</dd><dt>Class</dt><dd>This document can be used as a class/type for other documents.</dd><dt>Template</dt><dd>This document can be used as a template for new documents.</dd></dl>",2)],R={name:"AboutTypes"},F={name:"AboutView",components:{"app-instance":$,"app-keyboard":L,"app-predicates":E,"app-text":Z,"app-types":(0,x.Z)(R,[["render",function(e,t,o,i,n,l){return(0,u.wg)(),(0,u.iD)("section",null,H)}]])},data:()=>({tab:0})},Y=(0,x.Z)(F,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-tab"),s=(0,u.up)("v-tabs"),r=(0,u.up)("app-instance"),d=(0,u.up)("v-window-item"),c=(0,u.up)("app-keyboard"),p=(0,u.up)("app-types"),m=(0,u.up)("app-predicates"),h=(0,u.up)("app-text"),v=(0,u.up)("v-window"),f=(0,u.up)("v-container");return(0,u.wg)(),(0,u.j4)(f,null,{default:(0,u.w5)((()=>[(0,u.Wm)(s,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t),grow:""},{default:(0,u.w5)((()=>[(0,u.Wm)(a,null,{default:(0,u.w5)((()=>[(0,u.Uk)("Instance")])),_:1}),(0,u.Wm)(a,null,{default:(0,u.w5)((()=>[(0,u.Uk)("Keyboard")])),_:1}),(0,u.Wm)(a,null,{default:(0,u.w5)((()=>[(0,u.Uk)("Types")])),_:1}),(0,u.Wm)(a,null,{default:(0,u.w5)((()=>[(0,u.Uk)("Predicates")])),_:1}),(0,u.Wm)(a,null,{default:(0,u.w5)((()=>[(0,u.Uk)("Text")])),_:1})])),_:1},8,["modelValue"]),(0,u.Wm)(v,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.tab=t),style:{padding:"2rem"}},{default:(0,u.w5)((()=>[(0,u.Wm)(d,null,{default:(0,u.w5)((()=>[(0,u.Wm)(r)])),_:1}),(0,u.Wm)(d,null,{default:(0,u.w5)((()=>[(0,u.Wm)(c)])),_:1}),(0,u.Wm)(d,null,{default:(0,u.w5)((()=>[(0,u.Wm)(p)])),_:1}),(0,u.Wm)(d,null,{default:(0,u.w5)((()=>[(0,u.Wm)(m)])),_:1}),(0,u.Wm)(d,null,{default:(0,u.w5)((()=>[(0,u.Wm)(h)])),_:1})])),_:1},8,["modelValue"])])),_:1})}]]),B=(0,u._)("br",null,null,-1),M={class:"outer"},N={name:"TagLine",props:{value:{type:Array,required:!0},size:{type:String,default:"default"}},emits:["click"],data:()=>({tags:[]}),watch:{value:function(){this.computeTags()}},mounted:function(){this.computeTags()},methods:{computeTags:async function(){const e=[],t=U();for(const o of this.value)e.push({iri:o,label:await t.getLabel(o)});this.tags=e},onClick:function(){this.$emit("click")}}},Q=(0,x.Z)(N,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-chip");return(0,u.wg)(),(0,u.iD)("span",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.tags,(t=>((0,u.wg)(),(0,u.j4)(a,{key:t.iri,size:e.size,class:"ma-1",onClick:e.onClick},{default:(0,u.w5)((()=>[(0,u.Uk)((0,d.zw)(t.label),1)])),_:2},1032,["size","onClick"])))),128))])}]]),G={name:"TypeLine",components:{"app-tags":Q},props:{value:{type:Object,required:!0}},emits:["input"],methods:{onEditType:function(){this.$emit("input",this.value)}}},J=(0,x.Z)(G,[["render",function(e,t,o,n,l,a){const s=(0,u.up)("app-tags"),r=(0,u.up)("v-btn");return(0,u.wg)(),(0,u.iD)("span",null,[(0,u.Wm)(s,{value:e.value.types,onClick:e.onEditType},null,8,["value","onClick"]),(0,u.wy)((0,u.Wm)(r,{size:"small",variant:"text",icon:"mdi-plus",onClick:e.onEditType},null,8,["onClick"]),[[i.F8,0===e.value.types.length]])])}]]),X={name:"PropertiesPreview",props:{value:{type:Object,required:!0}},data:()=>({loading:!1,content:[]}),watch:{"value.properties":async function(e){await this.updateProperties(e)}},mounted:async function(){await this.updateProperties(this.value.properties)},methods:{updateProperties:async function(e){const t=U(),o=[];for(const[i,n]of Object.entries(e)){const e=await t.getPredicate(i),l=await ee(t,e,n);o.push({iri:i,label:e.label,items:l})}o.sort(((e,t)=>e.label.localeCompare(t.label))),this.content=o}}};async function ee(e,t,o){let i=[];if("codelist"===t.type)for(const t of o)i.push(await e.getLabel(t));else i=o;return i}const te=(0,x.Z)(X,[["render",function(e,t,o,i,n,l){return(0,u.wg)(),(0,u.iD)("div",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.content,(e=>((0,u.wg)(),(0,u.iD)("dl",{key:e.iri},[(0,u._)("dt",null,(0,d.zw)(e.label)+":",1),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.items,((e,t)=>((0,u.wg)(),(0,u.iD)("dd",{key:t},(0,d.zw)(e),1)))),128))])))),128))])}],["__scopeId","data-v-a3e9327a"]]),oe={name:"DocumentDetailHeader",components:{"app-types":J,"app-properties-preview":te},props:{modelValue:{type:Object,required:!0}},emits:["update:model-value","edit-type","edit-properties","save","close"],methods:{onCopyIri:function(){navigator.clipboard.writeText(this.modelValue.iri)},onChangeTitle:function(e){this.$emit("update:model-value",{...this.modelValue,title:e})},onChangeDescription:function(e){this.$emit("update:model-value",{...this.modelValue,description:e})},onEditType:function(e){this.$emit("edit-type",e)},onEditProperties:function(){this.$emit("edit-properties",this.modelValue)},onSave:function(){this.$emit("save")},onClose:function(){this.$emit("close")}}},ie=(0,x.Z)(oe,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-btn"),s=(0,u.up)("app-types"),r=(0,u.up)("v-text-field"),d=(0,u.up)("v-textarea"),c=(0,u.up)("app-properties-preview"),p=(0,u.up)("v-layout");return(0,u.wg)(),(0,u.iD)("div",null,[(0,u._)("div",null,[(0,u.Wm)(a,{icon:"mdi-share-variant",size:"small",variant:"text",class:"ml-2 mr-4",onClick:e.onCopyIri},null,8,["onClick"]),(0,u.Wm)(a,{icon:"mdi-pencil",size:"small",variant:"text",class:"mr-4",onClick:t[0]||(t[0]=t=>e.onEditProperties(e.modelValue))}),(0,u.Wm)(s,{value:e.modelValue,onInput:e.onEditType},null,8,["value","onInput"])]),(0,u.Wm)(r,{"model-value":e.modelValue.title,label:"Title *",required:"","onUpdate:modelValue":e.onChangeTitle},null,8,["model-value","onUpdate:modelValue"]),(0,u.Wm)(d,{"model-value":e.modelValue.description,"auto-grow":"",clearable:"","clear-icon":"mdi-close-circle",rows:"1",label:"Description","onUpdate:modelValue":e.onChangeDescription},null,8,["model-value","onUpdate:modelValue"]),(0,u._)("div",M,[(0,u.Uk)(" Properties: "),(0,u.Wm)(c,{value:e.modelValue},null,8,["value"])]),(0,u.Wm)(p,null,{default:(0,u.w5)((()=>[(0,u.Wm)(a,{class:"mr-4",onClick:e.onSave},{default:(0,u.w5)((()=>[(0,u.Uk)(" Save ")])),_:1},8,["onClick"]),(0,u.Wm)(a,{onClick:e.onClose},{default:(0,u.w5)((()=>[(0,u.Uk)(" Close ")])),_:1},8,["onClick"])])),_:1})])}],["__scopeId","data-v-f12837fa"]]),ne={class:"v-list"},le=["src"],ae={name:"NoteEdit",props:{value:{type:Object,required:!0},documentIri:{type:String,required:!0}},emits:["input","delete","add","edit-properties"],data:()=>({showImage:!1}),computed:{isQuote:function(){return(this.value.types??[]).includes(k)}},methods:{onCopyIri:function(){const e=this.documentIri+"/notes/"+this.value.identifier;navigator.clipboard.writeText(e)},onChangeContent:function(e){this.$emit("input",{...this.value,text:e})},onClearImage:function(){this.$emit("input",{...this.value,image:void 0})},onDelete:function(){this.$emit("delete")},onAdd:function(){this.$emit("add")},onKeyDown:function(e){e.altKey&&"q"===e.key&&(this.onToggleQuote(),e.preventDefault())},onPaste:function(e){for(const t of e.clipboardData.items){if(!t.type.includes("image"))continue;e.preventDefault();const o=t.getAsFile(),i=new FileReader;i.onload=()=>{const e=i.result;this.$emit("input",{...this.value,image:e})},i.readAsDataURL(o);break}},onEditProperties:function(){this.$emit("edit-properties",this.value)},onToggleImage:function(){this.showImage=!this.showImage},onToggleQuote:function(){this.$emit("input",function(e){const t=e.types??[];let o;const i=t.indexOf(k);return o=-1===i?[...t,k]:[...t.slice(0,i),...t.slice(i+1)],{...e,types:o}}(this.value))}}};function se(e,t){const o=t.map((e=>Number(e.identifier))).reduce(((e,t)=>Math.max(e,t)),0)+1;let i=[];return t.length>0&&(i=[...t[t.length-1].types]),function(e,t,o=[]){return{identifier:e,types:o,properties:{},created:(new Date).toISOString().substr(0,10),text:t,image:void 0}}(String(o).padStart(3,"0"),"",i)}function re(){return[...window.document.querySelectorAll(".note-content-input textarea:first-of-type")]}const ue={name:"DocumentDetailNotes",components:{"app-item":(0,x.Z)(ae,[["render",function(e,t,o,n,l,a){const s=(0,u.up)("v-btn"),r=(0,u.up)("v-switch"),d=(0,u.up)("v-spacer"),c=(0,u.up)("v-card-title"),p=(0,u.up)("v-textarea"),m=(0,u.up)("v-card-text"),h=(0,u.up)("v-card-actions"),v=(0,u.up)("v-card");return(0,u.wg)(),(0,u.j4)(v,{class:"mx-2",width:"100%"},{default:(0,u.w5)((()=>[(0,u.Wm)(c,{class:"py-0 flex"},{default:(0,u.w5)((()=>[(0,u.Wm)(s,{icon:"mdi-share-variant",size:"small",class:"ml-2 mr-4",onClick:e.onCopyIri},null,8,["onClick"]),(0,u.Wm)(s,{icon:"mdi-pencil",size:"small",class:"mr-4",onClick:t[0]||(t[0]=t=>e.onEditProperties(e.value))}),(0,u.Wm)(r,{"model-value":e.isQuote,label:"Quote",density:"compact","onUpdate:modelValue":e.onToggleQuote},null,8,["model-value","onUpdate:modelValue"]),(0,u.Wm)(d),(0,u.Wm)(s,{icon:"mdi-minus",size:"small",variant:"text",color:"red",class:"mr-4",onClick:e.onDelete},null,8,["onClick"]),(0,u.Wm)(s,{icon:"mdi-plus",size:"small",variant:"text",color:"green",onClick:t[1]||(t[1]=t=>e.onAdd())})])),_:1}),(0,u.Wm)(m,null,{default:(0,u.w5)((()=>[(0,u.Wm)(p,{"model-value":e.value.text,class:"note-content-input","auto-grow":"",clearable:"","clear-icon":"mdi-close-circle",rows:"1",label:"Content","hide-details":!0,"onUpdate:modelValue":e.onChangeContent,onPaste:e.onPaste,onKeydown:e.onKeyDown},null,8,["model-value","onUpdate:modelValue","onPaste","onKeydown"]),(0,u.wy)((0,u._)("img",{src:e.value.image,style:{"border-style":"ridge","background-color":"wheat",width:"100%"}},null,8,le),[[i.F8,e.value.image&&e.showImage]])])),_:1}),(0,u.wy)((0,u.Wm)(h,null,{default:(0,u.w5)((()=>[(0,u.Wm)(s,{onClick:e.onToggleImage},{default:(0,u.w5)((()=>[(0,u.Uk)(" Toggle Image ")])),_:1},8,["onClick"]),(0,u.wy)((0,u.Wm)(s,{onClick:e.onClearImage},{default:(0,u.w5)((()=>[(0,u.Uk)(" Clear Image ")])),_:1},8,["onClick"]),[[i.F8,e.showImage]])])),_:1},512),[[i.F8,e.value.image]])])),_:1})}],["__scopeId","data-v-7a1a1498"]])},props:{documentIri:{type:String,required:!0},modelValue:{type:Array,required:!0}},emits:["update:model-value","edit-properties"],methods:{onChange:function(e,t){this.$emit("update:model-value",[...this.modelValue.slice(0,e),t,...this.modelValue.slice(e+1)])},onInsert:function(e){this.$emit("update:model-value",[...this.modelValue.slice(0,e+1),se(this.iri,this.modelValue),...this.modelValue.slice(e+1)])},onDelete:function(e){this.$emit("update:model-value",[...this.modelValue.slice(0,e),...this.modelValue.slice(e+1)])},onAppend:function(){this.$emit("update:model-value",[...this.modelValue,se(this.iri,this.modelValue)])},onEditProperties:function(e){this.$emit("edit-properties",e)}}},de=(0,x.Z)(ue,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("app-item"),s=(0,u.up)("v-list-item"),r=(0,u.up)("v-btn");return(0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u.kq)("\n    We can not use v-list here.\n    The v-list capture arrows, Home, End and use them to navigate the list.\n    We do not need this as we need to capture the keys on your own.\n   "),(0,u._)("div",ne,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.modelValue,((t,o)=>((0,u.wg)(),(0,u.j4)(s,{key:t.iri},{default:(0,u.w5)((()=>[(0,u.Wm)(a,{"document-iri":e.documentIri,value:t,onInput:t=>e.onChange(o,t),onAdd:()=>e.onInsert(o),onDelete:()=>e.onDelete(o),onEditProperties:e.onEditProperties},null,8,["document-iri","value","onInput","onAdd","onDelete","onEditProperties"])])),_:2},1024)))),128)),(0,u.Wm)(s,null,{default:(0,u.w5)((()=>[(0,u.Wm)(r,{icon:"mdi-plus",color:"green",variant:"text",onClick:t[0]||(t[0]=t=>e.onAppend())})])),_:1})])],2112)}]]),ce={class:"flex"},pe={name:"PropertiesDialogItem",props:{predicate:{type:String,required:!0},modelValue:{type:Array,required:!0}},emits:["update:model-value","delete"],data:()=>({definition:{},loading:!1,items:[]}),mounted:async function(){const e=U();if(this.loading=!0,this.definition=await e.getPredicate(this.predicate)||{},"codelist"===this.definition.type){const t=await e.getCodelist(this.definition.codelist),o=[];for(const i of t)o.push({iri:i,title:await e.getLabel(i)});this.items=o}this.loading=!1},methods:{onDelete:function(){this.$emit("delete")},onAddValue:function(e){this.$emit("update:model-value",[...this.modelValue.slice(0,e+1),"",...this.modelValue.slice(e+1)])},onDeleteValue:function(e){this.$emit("update:model-value",[...this.modelValue.slice(0,e),...this.modelValue.slice(e+1)])},onUpdateValue:function(e,t){this.$emit("update:model-value",[...this.modelValue.slice(0,e),t,...this.modelValue.slice(e+1)])}}},me={name:"PropertySelector",props:{label:{type:String,required:!0},types:{type:Array,required:!1,default:void 0}},emits:["add"],data:()=>({value:"",loading:!1,items:[],filteredItems:[],search:null}),watch:{value:function(e){"object"==typeof e&&(this.$emit("add",e),(0,u.Y3)((()=>{this.value="",this.$refs.input.blur()})))},types:function(e){this.updateFilteredItems(e)}},mounted:async function(){this.loading=!0,this.items=await U().getPredicates(),this.updateFilteredItems(this.types),this.loading=!1},methods:{updateFilteredItems:function(e){this.filteredItems=this.items.filter((t=>function(e,t){if(void 0===e||0===e.length)return!0;if(void 0===t)return!1;for(const o of t)if(e.includes(o))return!0;return!1}(t.domain,e)))}}},he={name:"PropertiesDialog",components:{"app-property-edit":(0,x.Z)(pe,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-btn"),s=(0,u.up)("v-list-subheader"),r=(0,u.up)("v-text-field"),c=(0,u.up)("v-select"),p=(0,u.up)("v-list-item"),m=(0,u.up)("v-list");return(0,u.wg)(),(0,u.j4)(m,{class:"py-0"},{default:(0,u.w5)((()=>[(0,u.Wm)(s,null,{default:(0,u.w5)((()=>[(0,u.Wm)(a,{icon:"mdi-minus",color:"red",size:"x-small",variant:"text",onClick:e.onDelete},null,8,["onClick"]),(0,u.Uk)(" "+(0,d.zw)(e.definition.label),1)])),_:1}),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.modelValue,((t,o)=>((0,u.wg)(),(0,u.j4)(p,{key:o},{default:(0,u.w5)((()=>[(0,u._)("div",ce,[e.definition.multiple?((0,u.wg)(),(0,u.j4)(a,{key:0,icon:"mdi-plus",variant:"text",size:"small",onClick:t=>e.onAddValue(o)},null,8,["onClick"])):(0,u.kq)("v-if",!0),e.definition.multiple?((0,u.wg)(),(0,u.j4)(a,{key:1,icon:"mdi-minus",variant:"text",size:"small",onClick:t=>e.onDeleteValue(o)},null,8,["onClick"])):(0,u.kq)("v-if",!0),"date"===e.definition.type?((0,u.wg)(),(0,u.j4)(r,{key:2,"model-value":t,type:"date",density:"compact","hide-details":!0,"onUpdate:modelValue":t=>e.onUpdateValue(o,t)},null,8,["model-value","onUpdate:modelValue"])):(0,u.kq)("v-if",!0),"string"===e.definition.type?((0,u.wg)(),(0,u.j4)(r,{key:3,"model-value":t,density:"compact","hide-details":!0,"onUpdate:modelValue":t=>e.onUpdateValue(o,t)},null,8,["model-value","onUpdate:modelValue"])):"codelist"===e.definition.type?((0,u.wg)(),(0,u.j4)(c,{key:4,"model-value":t,items:e.items,"item-text":"title","item-value":"iri",density:"compact","hide-details":!0,"onUpdate:modelValue":t=>e.onUpdateValue(o,t)},null,8,["model-value","items","onUpdate:modelValue"])):(0,u.kq)("v-if",!0)])])),_:2},1024)))),128)),0===e.modelValue.length?((0,u.wg)(),(0,u.j4)(p,{key:0},{default:(0,u.w5)((()=>[(0,u.Wm)(a,{icon:"mdi-plus",size:"x-small",onClick:t[0]||(t[0]=t=>e.onAddValue())})])),_:1})):(0,u.kq)("v-if",!0)])),_:1})}],["__scopeId","data-v-0b59a0ee"]]),"app-property-selector":(0,x.Z)(me,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-combobox");return(0,u.wg)(),(0,u.j4)(a,{ref:"input",modelValue:e.value,"onUpdate:modelValue":t[0]||(t[0]=t=>e.value=t),loading:e.loading,disabled:e.loading,items:e.filteredItems,label:e.label,class:"px-4","item-value":"iri","item-title":"label","return-object":"",autofocus:""},null,8,["modelValue","loading","disabled","items","label"])}]])},props:{modelValue:{type:Object,required:!0},visible:{type:Boolean,required:!0},types:{type:Array,required:!0}},emits:["update:model-value","close","save"],methods:{onChange:function(e,t){this.$emit("update:model-value",{...this.modelValue,[e]:t})},onDelete:function(e){const t={...this.modelValue};delete t[e],this.$emit("update:model-value",t)},onAdd:function(e){void 0===this.modelValue[e.iri]&&this.$emit("update:model-value",{...this.modelValue,[e.iri]:[""]})},onSave:function(){this.$emit("save")},onClose:function(){this.$emit("close")}}},ve=(0,x.Z)(he,[["render",function(e,t,o,n,l,a){const s=(0,u.up)("v-btn"),r=(0,u.up)("v-toolbar-title"),d=(0,u.up)("v-spacer"),c=(0,u.up)("v-toolbar-items"),p=(0,u.up)("v-toolbar"),m=(0,u.up)("app-property-edit"),h=(0,u.up)("v-list-item-title"),v=(0,u.up)("v-list-item"),f=(0,u.up)("app-property-selector"),g=(0,u.up)("v-list"),w=(0,u.up)("v-card"),y=(0,u.up)("v-dialog");return(0,u.wg)(),(0,u.j4)(y,{"model-value":e.visible,fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition",onKeydown:(0,i.D2)(e.onClose,["esc"])},{default:(0,u.w5)((()=>[(0,u.Wm)(w,null,{default:(0,u.w5)((()=>[(0,u.Wm)(p,{dark:"",color:"primary"},{default:(0,u.w5)((()=>[(0,u.Wm)(s,{icon:"mdi-check",onClick:e.onSave},null,8,["onClick"]),(0,u.Wm)(r,null,{default:(0,u.w5)((()=>[(0,u.Uk)("Edit Properties")])),_:1}),(0,u.Wm)(d),(0,u.Wm)(c,null,{default:(0,u.w5)((()=>[(0,u.Wm)(s,{icon:"mdi-close",onClick:e.onClose},null,8,["onClick"])])),_:1})])),_:1}),(0,u.Wm)(g,null,{default:(0,u.w5)((()=>[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(Object.entries(e.modelValue),(t=>((0,u.wg)(),(0,u.j4)(v,{key:t[0]},{default:(0,u.w5)((()=>[(0,u.Wm)(h,null,{default:(0,u.w5)((()=>[(0,u.Wm)(m,{predicate:t[0],"model-value":t[1],"onUpdate:modelValue":o=>e.onChange(t[0],o),onDelete:o=>e.onDelete(t[0])},null,8,["predicate","model-value","onUpdate:modelValue","onDelete"])])),_:2},1024)])),_:2},1024)))),128)),(0,u.Wm)(v,null,{default:(0,u.w5)((()=>[(0,u.Wm)(f,{label:"Add new predicate",types:e.types,onAdd:e.onAdd},null,8,["types","onAdd"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model-value","onKeydown"])}]]),fe={name:"CodelistDialog",props:{modelValue:{type:Array,required:!0},codelist:{type:Array,required:!0},visible:{type:Boolean,required:!0},multiple:{type:Boolean,default:!0},refreshOnShow:{type:Boolean,default:!1}},emits:["update:model-value","close","save"],data:()=>({items:[],loading:!1}),watch:{visible:async function(e){e&&(console.log("onShow",this.modelValue),this.refreshOnShow&&await this.reloadCodelistFromDatabase())}},mounted:async function(){await this.reloadCodelistFromDatabase(),console.log("mounted",this.items)},methods:{reloadCodelistFromDatabase:async function(){const e=U();this.loading=!0;const t=await e.getCodelist(this.codelist),o=[];for(const i of t)o.push({iri:i,title:await e.getLabel(i)});this.items=o,this.loading=!1},onChange:function(e){this.multiple||(e=[e]),console.log("onChange",e),this.$emit("update:model-value",e)},onClose:function(){console.log("onClose",this.modelValue),this.$emit("close")},onSave:function(){console.log("onSave",this.modelValue),this.$emit("save",this.modelValue)}}},ge=(0,x.Z)(fe,[["render",function(e,t,o,n,l,a){const s=(0,u.up)("v-card-title"),r=(0,u.up)("v-select"),d=(0,u.up)("v-card-text"),c=(0,u.up)("v-divider"),p=(0,u.up)("v-btn"),m=(0,u.up)("v-card-actions"),h=(0,u.up)("v-card"),v=(0,u.up)("v-dialog");return(0,u.wg)(),(0,u.j4)(v,{"model-value":e.visible,persistent:"",onKeydown:(0,i.D2)(e.onClose,["esc"])},{default:(0,u.w5)((()=>[(0,u.Wm)(h,null,{default:(0,u.w5)((()=>[(0,u.Wm)(s,{class:"headline"},{default:(0,u.w5)((()=>[(0,u.Uk)(" Type ")])),_:1}),(0,u.Wm)(d,{class:"mt-4"},{default:(0,u.w5)((()=>[(0,u.Wm)(r,{"model-value":e.modelValue,items:e.items,"item-title":"title","item-value":"iri",label:"Type",multiple:e.multiple,chips:"","onUpdate:modelValue":e.onChange},null,8,["model-value","items","multiple","onUpdate:modelValue"])])),_:1}),(0,u.Wm)(c),(0,u.Wm)(m,null,{default:(0,u.w5)((()=>[(0,u.Wm)(p,{color:"primary",text:"",onClick:e.onSave},{default:(0,u.w5)((()=>[(0,u.Uk)(" Save ")])),_:1},8,["onClick"]),(0,u.Wm)(p,{text:"",onClick:e.onClose},{default:(0,u.w5)((()=>[(0,u.Uk)(" Close ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["model-value","onKeydown"])}]]),we={name:"DocumentDetailView",components:{"app-header":ie,"app-items":de,"app-property-dialog":ve,"app-codelist-dialog":ge},data:()=>({document:{iri:v().domain+((new Date).getTime()+"-xxxx-yxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))),types:[],title:"",description:"",created:(new Date).toISOString().substr(0,10),properties:{},items:[]},loading:!1,propertyDialog:{open:!1,owner:void 0,types:[],data:{}},typeDialog:{open:!1,owner:void 0,data:[]}}),mounted:async function(){window.document.addEventListener("keydown",this.onKeyDown);const e=this.$route.query.document;if(void 0===e)return;this.loading=!0;const t=await U().getDocument(e);void 0!==t&&(this.document=t),this.loading=!1},unmounted:function(){window.document.removeEventListener("keydown",this.onKeyDown)},methods:{onKeyDown:function(e){e.ctrlKey&&"s"===e.key?(this.onSave(),e.preventDefault()):e.altKey&&"a"===e.key?(this.document.items=[...this.document.items,se(this.document.iri,this.document.items)],(0,u.Y3)((()=>{re().pop().focus()})),e.preventDefault()):e.altKey&&"ArrowUp"===e.key?(function(){const e=re(),t=document.activeElement,o=e.indexOf(t);o<1||o-1>e.length||e[o-1].focus()}(),e.preventDefault()):e.altKey&&"ArrowDown"===e.key&&(function(){const e=re(),t=document.activeElement,o=e.indexOf(t);-1===o||o+1>=e.length||e[o+1].focus()}(),e.preventDefault())},onOpenPropertiesDialog:function(e){this.propertyDialog={open:!0,owner:e,types:e?.types??["https://skodapetr.github.io/knoma/vocabulary#Note"],data:ye(e.properties)}},onClosePropertiesDialog:function(){this.propertyDialog.open=!1},onSavePropertiesDialog:function(){this.propertyDialog.owner.properties=this.propertyDialog.data,this.propertyDialog.open=!1},onOpenTypeDialog:function(e){this.typeDialog={open:!0,owner:e,data:[...e.types]}},onSaveTypeDialog:function(){this.typeDialog.owner.types=this.typeDialog.data,this.typeDialog.open=!1},onCloseTypeDialog:function(){this.typeDialog.open=!1},onSave:async function(){this.loading=!0;try{await U().storeDocument(this.document),this.$notify({title:"Document saved.",type:"success"})}catch(e){throw this.$notify({title:"Can't save data.",type:"error"}),e}this.loading=!1},onClose:function(){this.$router.push({name:"documents"})}}};function ye(e){const t={};for(const[o,i]of Object.entries(e))Array.isArray(i)?t[o]=[...i]:t[o]="object"==typeof i?{...i}:i;return t}const be=(0,x.Z)(we,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("app-header"),s=(0,u.up)("app-items"),r=(0,u.up)("app-property-dialog"),d=(0,u.up)("app-codelist-dialog"),c=(0,u.up)("v-btn"),p=(0,u.up)("v-layout"),m=(0,u.up)("v-container");return(0,u.wg)(),(0,u.j4)(m,{class:"pt-0"},{default:(0,u.w5)((()=>[(0,u.Wm)(a,{modelValue:e.document,"onUpdate:modelValue":t[0]||(t[0]=t=>e.document=t),onEditProperties:e.onOpenPropertiesDialog,onEditType:e.onOpenTypeDialog,onSave:e.onSave,onClose:e.onClose},null,8,["modelValue","onEditProperties","onEditType","onSave","onClose"]),B,(0,u.Wm)(s,{modelValue:e.document.items,"onUpdate:modelValue":t[1]||(t[1]=t=>e.document.items=t),"document-iri":e.document.iri,onEditProperties:e.onOpenPropertiesDialog},null,8,["modelValue","document-iri","onEditProperties"]),(0,u.Wm)(r,{modelValue:e.propertyDialog.data,"onUpdate:modelValue":t[2]||(t[2]=t=>e.propertyDialog.data=t),visible:e.propertyDialog.open,types:e.propertyDialog.types,onSave:e.onSavePropertiesDialog,onClose:e.onClosePropertiesDialog},null,8,["modelValue","visible","types","onSave","onClose"]),(0,u.Wm)(d,{modelValue:e.typeDialog.data,"onUpdate:modelValue":t[3]||(t[3]=t=>e.typeDialog.data=t),visible:e.typeDialog.open,codelist:["http://www.w3.org/2000/01/rdf-schema#Class"],onSave:e.onSaveTypeDialog,onClose:e.onCloseTypeDialog},null,8,["modelValue","visible","codelist","onSave","onClose"]),(0,u.Wm)(p,{class:"mt-6"},{default:(0,u.w5)((()=>[(0,u.Wm)(c,{class:"mr-4",onClick:e.onSave},{default:(0,u.w5)((()=>[(0,u.Uk)(" Save ")])),_:1},8,["onClick"]),(0,u.Wm)(c,{onClick:e.onClose},{default:(0,u.w5)((()=>[(0,u.Uk)(" Close ")])),_:1},8,["onClick"])])),_:1})])),_:1})}]]),Ce={class:"floating-menu"},ke={name:"DocumentListItem",components:{"app-tags":Q},props:{value:{type:Object,required:!0}},emits:["open","delete"],data:()=>({tags:[]}),mounted:async function(){await this.refresh()},methods:{onOpen:function(e){this.$emit("open",{iri:this.value.iri,ctrlKey:e.ctrlKey})},onDelete:function(){this.$emit("delete",this.value.iri)},refresh:async function(){this.tags=await async function(e){const t=U(),o=[];for(const i of Object.keys(e.properties).sort()){const n=await t.getPredicate(i);if(void 0===n)continue;const l=n.listColour;if(void 0===l)continue;const a=n.listPriority??0;if(n.type===f.Codelist)for(const n of e.properties[i]){const e=await t.getLabel(n);o.push({label:e,color:l,priority:a})}else for(const t of e.properties[i])o.push({label:t,color:l,priority:a})}return o.sort(((e,t)=>t.priority-e.priority)),o}(this.value)}}},De=(0,x.Z)(ke,[["render",function(e,t,o,n,l,a){const s=(0,u.up)("v-list-item-title"),r=(0,u.up)("app-tags"),c=(0,u.up)("v-chip"),p=(0,u.up)("v-list-item-subtitle"),m=(0,u.up)("v-btn"),h=(0,u.up)("v-list-item");return(0,u.wg)(),(0,u.j4)(h,{onClick:e.onOpen},{append:(0,u.w5)((()=>[(0,u.Wm)(m,{color:"red",icon:"mdi-delete",variant:"text",onClick:(0,i.iM)(e.onDelete,["stop"])},null,8,["onClick"])])),default:(0,u.w5)((()=>[(0,u.Wm)(s,null,{default:(0,u.w5)((()=>[(0,u.Uk)((0,d.zw)(e.value.title||e.value.iri),1)])),_:1}),(0,u.Wm)(p,null,{default:(0,u.w5)((()=>[(0,u.Wm)(r,{value:e.value.types,size:"small"},null,8,["value"]),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.tags,((e,t)=>((0,u.wg)(),(0,u.j4)(c,{key:t,color:e.color,size:"small",variant:"outlined",class:"ma-1"},{default:(0,u.w5)((()=>[(0,u.Uk)((0,d.zw)(e.label),1)])),_:2},1032,["color"])))),128))])),_:1})])),_:1},8,["onClick"])}]]),Ve={class:"pb-2"},We={class:"tag-line"},_e={name:"TypeFilter",components:{"app-codelist-dialog":ge},props:{value:{type:Object,required:!0}},emits:["input","change"],data:()=>({dialog:{items:[],visible:!1,include:!0},tags:[]}),watch:{"value.types":function(e,t){e!==t&&this.computeTags()}},methods:{onAddInclude:function(){this.dialog.visible=!0,this.dialog.include=!0},onAddExclude:function(){this.dialog.visible=!0,this.dialog.include=!1},onSaveTypeDialog:function(e){if(this.dialog.visible=!1,this.dialog.items=[],0===e.length)return;const t=e[0];for(const e in this.value.types){const o=this.value.types[e];if(o.iri===t){if(o.include===this.dialog.include)return;return this.$emit("input",{...this.value,types:[...this.value.types.slice(0,e),{iri:t,include:this.dialog.include},...this.value.types.slice(e+1)]}),void this.$emit("change")}}this.$emit("input",{...this.value,types:[...this.value.types,{iri:t,include:this.dialog.include}]}),this.$emit("change")},computeTags:async function(){const e=[],t=U();for(const o of this.value.types)e.push({iri:o.iri,label:await t.getLabel(o.iri),include:o.include});this.tags=e},onCloseTypeDialog:function(){this.dialog.visible=!1,this.dialog.items=[]},onRemoveType:function(e){this.$emit("input",{...this.value,types:[...this.value.types.slice(0,e),...this.value.types.slice(e+1)]}),this.$emit("change")}}},Se={name:"PropertyFilter",components:{"app-property-dialog":ve,"app-properties-preview":te},props:{value:{type:Object,required:!0}},emits:["input","change"],data:()=>({properties:{},visible:!1,types:[]}),methods:{onOpenPropertiesDialog:function(){this.properties=function(e){const t={};for(const[o,i]of Object.entries(e))t[o]=[...i];return t}(this.value.properties),this.visible=!0},onClear:function(){this.$emit("input",{...this.value,properties:{}}),this.$emit("change")},onSavePropertiesDialog:async function(){this.visible=!1,this.$emit("input",{...this.value,properties:this.properties}),this.$emit("change")},onClosePropertiesDialog:function(){this.visible=!1}}},Pe={name:"DocumentFilter",components:{"app-type-filter":(0,x.Z)(_e,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-btn"),s=(0,u.up)("v-chip"),r=(0,u.up)("app-codelist-dialog");return(0,u.wg)(),(0,u.iD)("div",null,[(0,u._)("div",null,[(0,u.Uk)(" Types:   "),(0,u.Wm)(a,{icon:"mdi-plus",size:"x-small",onClick:e.onAddInclude},null,8,["onClick"]),(0,u.Uk)("   "),(0,u.Wm)(a,{icon:"mdi-minus",size:"x-small",onClick:e.onAddExclude},null,8,["onClick"])]),(0,u._)("div",We,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.tags,((t,o)=>((0,u.wg)(),(0,u.j4)(s,{key:t.iri,color:t.include?"green":"red",size:"small",class:"mr-2",closable:"","onClick:close":t=>e.onRemoveType(o)},{default:(0,u.w5)((()=>[(0,u.Uk)((0,d.zw)(t.label),1)])),_:2},1032,["color","onClick:close"])))),128))]),(0,u.Wm)(r,{modelValue:e.dialog.items,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialog.items=t),visible:e.dialog.visible,codelist:["http://www.w3.org/2000/01/rdf-schema#Class"],multiple:!1,onSave:e.onSaveTypeDialog,onClose:e.onCloseTypeDialog},null,8,["modelValue","visible","codelist","onSave","onClose"])])}],["__scopeId","data-v-7482b648"]]),"app-property-filter":(0,x.Z)(Se,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-btn"),s=(0,u.up)("app-properties-preview"),r=(0,u.up)("app-property-dialog");return(0,u.wg)(),(0,u.iD)("div",null,[(0,u._)("div",null,[(0,u.Uk)(" Properties:   "),(0,u.Wm)(a,{size:"small",onClick:e.onOpenPropertiesDialog},{default:(0,u.w5)((()=>[(0,u.Uk)(" Edit ")])),_:1},8,["onClick"]),(0,u.Uk)("   "),(0,u.Wm)(a,{size:"small",onClick:e.onClear},{default:(0,u.w5)((()=>[(0,u.Uk)(" Clear ")])),_:1},8,["onClick"])]),(0,u.Wm)(s,{value:e.value},null,8,["value"]),(0,u.Wm)(r,{modelValue:e.properties,"onUpdate:modelValue":t[0]||(t[0]=t=>e.properties=t),visible:e.visible,types:e.types,onSave:e.onSavePropertiesDialog,onClose:e.onClosePropertiesDialog},null,8,["modelValue","visible","types","onSave","onClose"])])}]])},props:{modelValue:{type:Object,required:!0}},emits:["update:model-value","change"],methods:{onSearchInput:function(e){this.$emit("update:model-value",{...this.modelValue,search:e}),this.$emit("change")},onChange:function(){this.$emit("change")},onInput:function(e){this.$emit("update:model-value",e)}}},Ie=(0,x.Z)(Pe,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-text-field"),s=(0,u.up)("app-type-filter"),r=(0,u.up)("app-property-filter");return(0,u.wg)(),(0,u.iD)("div",Ve,[(0,u.Wm)(a,{label:"Text search",value:e.modelValue.search,"onUpdate:modelValue":e.onSearchInput,onChange:e.onChange},null,8,["value","onUpdate:modelValue","onChange"]),(0,u.Wm)(s,{value:e.modelValue,onInput:e.onInput,onChange:e.onChange},null,8,["value","onInput","onChange"]),(0,u.Wm)(r,{value:e.modelValue,onInput:e.onInput,onChange:e.onChange},null,8,["value","onInput","onChange"])])}]]);class Ue{search="";types=[];properties={}}class Te{documents=[];visibleDocuments=[];filters=new Ue;visibleLimit=12;async refresh(){const e=U(),t=await e.getDocuments();this.documents=t.filter((e=>this.filterDocument(e))),this.visibleDocuments=this.documents.slice(0,this.visibleLimit)}filterDocument(e){return this.filterBySearch(e)&&this.filterByType(e)&&this.filterByProperties(e)}filterBySearch(e){const t=this.filters.search;return void 0===t||null==t||t.length<2||!!e.title.toLowerCase().includes(t.toLowerCase())}filterByType(e){const t=this.filters.types;if(0===t.length)return!0;const o=e.types;for(const e of t)if(o.includes(e.iri)!==e.include)return!1;return!0}filterByProperties(e){for(const[t,o]of Object.entries(this.filters.properties)){const i=e.properties[t];if(void 0===i)return!1;for(const e of o)if(""!==e&&!i.includes(e))return!1}return!0}showMore(){this.visibleLimit+=12,this.visibleDocuments=this.documents.slice(0,this.visibleLimit)}}const xe={name:"DocumentListView",components:{"app-item":De,"app-filter":Ie},data:()=>({source:new Te,loading:!1}),mounted:async function(){await this.reload()},methods:{onOpen:function(e){const t={name:"document-edit",query:{document:e.iri}};if(e.ctrlKey){const e=this.$router.resolve(t).href;window.open(e,"_blank")}else this.$router.push(t)},onDelete:async function(e){this.loading=!0;const t=U();await t.deleteDocument(e),this.loading=!1,await this.reload()},onCreate:function(){this.$router.push({name:"document-edit"})},reload:async function(){this.loading=!0,await this.source.refresh(),this.loading=!1},onShowMore:function(){this.source.showMore()}}},$e=(0,x.Z)(xe,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("app-filter"),s=(0,u.up)("app-item"),r=(0,u.up)("v-divider"),c=(0,u.up)("v-btn"),p=(0,u.up)("v-list-item"),m=(0,u.up)("v-list"),h=(0,u.up)("v-progress-circular"),v=(0,u.up)("v-overlay"),f=(0,u.up)("v-container");return(0,u.wg)(),(0,u.j4)(f,null,{default:(0,u.w5)((()=>[(0,u.Wm)(a,{modelValue:e.source.filters,"onUpdate:modelValue":t[0]||(t[0]=t=>e.source.filters=t),onChange:e.reload},null,8,["modelValue","onChange"]),(0,u.Wm)(m,{class:"item-list"},{default:(0,u.w5)((()=>[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.source.visibleDocuments,(t=>((0,u.wg)(),(0,u.j4)(s,{key:t.iri,value:t,onOpen:e.onOpen,onDelete:e.onDelete},null,8,["value","onOpen","onDelete"])))),128)),(0,u.Wm)(r),(0,u.Wm)(p,null,{default:(0,u.w5)((()=>[e.source.visibleLimit<e.source.documents.length?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("div",null," Showing "+(0,d.zw)(e.source.visibleLimit)+" out of "+(0,d.zw)(e.source.documents.length)+" documents. ",1),(0,u.Wm)(c,{class:"mt-2",onClick:e.onShowMore},{default:(0,u.w5)((()=>[(0,u.Uk)(" Show more ")])),_:1},8,["onClick"])],64)):((0,u.wg)(),(0,u.iD)(u.HY,{key:1},[(0,u.Uk)(" All of "+(0,d.zw)(e.source.documents.length)+" documents are visible. ",1)],64))])),_:1})])),_:1}),(0,u._)("div",Ce,[(0,u.Wm)(c,{color:"green darken-2",icon:"mdi-plus",onClick:e.onCreate},null,8,["onClick"])]),(0,u.Wm)(v,{value:e.loading},{default:(0,u.w5)((()=>[(0,u.Wm)(h,{size:50,color:"primary",indeterminate:""})])),_:1},8,["value"])])),_:1})}],["__scopeId","data-v-d516bb26"]]),Ae=[{path:"/",name:"home",component:$e},{path:"/document-edit",name:"document-edit",component:be},{path:"/documents",name:"documents",component:$e},{path:"/about",name:"about",component:Y}],Oe={name:"ApplicationLayout"},Le=(0,x.Z)(Oe,[["render",function(e,t,o,i,n,l){const a=(0,u.up)("v-app-bar-title"),s=(0,u.up)("v-spacer"),r=(0,u.up)("v-btn"),d=(0,u.up)("v-app-bar"),c=(0,u.up)("router-view"),p=(0,u.up)("v-main"),m=(0,u.up)("notifications"),h=(0,u.up)("v-app");return(0,u.wg)(),(0,u.j4)(h,null,{default:(0,u.w5)((()=>[(0,u.Wm)(d,null,{default:(0,u.w5)((()=>[(0,u.Wm)(a,null,{default:(0,u.w5)((()=>[(0,u.Uk)(" Knowledge Manager ")])),_:1}),(0,u.Wm)(s),(0,u.Wm)(r,{to:{name:"documents"},class:"mr-6"},{default:(0,u.w5)((()=>[(0,u.Uk)(" Documents ")])),_:1}),(0,u.Wm)(r,{to:{name:"about"},class:"mr-6"},{default:(0,u.w5)((()=>[(0,u.Uk)(" About ")])),_:1}),(0,u.Wm)(r,{href:"https://github.com/skodapetr/knoma/issues",rel:"noopener noreferrer",target:"_blank"},{default:(0,u.w5)((()=>[(0,u.Uk)(" GitHub ")])),_:1})])),_:1}),(0,u.Wm)(p,null,{default:(0,u.w5)((()=>[(0,u.Wm)(c)])),_:1}),(0,u.Wm)(m)])),_:1})}]]),je=(0,n.p7)({history:(0,n.r5)(),routes:Ae}),qe=(0,a.Rd)({components:s,directives:r,theme:{defaultTheme:"dark",themes:{dark:{colors:{primary:"#3739FF"}}}}}),Ee=(0,i.ri)(Le);Ee.use(qe),Ee.use(je),Ee.use(l.ZP),Ee.mount("#application")}},e=>{e.O(0,[216],(()=>(346,e(e.s=346)))),e.O()}]);
//# sourceMappingURL=main.6abbdb2da7aa4515.bundle.js.map